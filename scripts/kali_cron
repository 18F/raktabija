#!/usr/bin/env bash

# ensure we're being triggered by the timer
[[ $GO_TRIGGER_USER == "timer" ]] || [[ $TRAVIS_EVENT_TYPE == "cron" ]] || exit 0

# Get chandika env vars if we're running via Go
[[ -z "$GO_SERVER_URL" ]] || source /etc/environment

if [[ $(date +%u) -eq 4 ]]; then
    scripts/kali.py "${CHANDIKA}" "${CHANDIKA_API_KEY}"
fi

if [[ $(date +%u) -eq 7 ]]; then
    scripts/kali.py --no-dry-run "${CHANDIKA}" "${CHANDIKA_API_KEY}"
fi
